<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Timeless Shots — Gallery</title>
  <meta name="description" content="Timeless Shots gallery — a curated collection of portraits, weddings, events, street and nature photography." />
  <style>
    /* =======================
       Design tokens / base
       ======================= */
    :root{
      --bg:#070708;            /* page background (dark) */
      --card:#0f1720;          /* cards */
      --muted:#9aa6b2;         /* secondary text */
      --text:#e6eef6;          /* main text */
      --accent:#8b5cf6;        /* violet accent */
      --accent-2:#06b6d4;      /* cyan accent */
      --glass: rgba(255,255,255,0.03);
      --glass-2: rgba(255,255,255,0.02);
      --radius: 14px;
      --shadow: 0 10px 30px rgba(2,6,23,0.65);
      --ease: cubic-bezier(.2,.9,.25,1);
    }

    /* reset */
    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(900px 500px at 5% 10%, rgba(139,92,246,0.08), transparent 8%),
                  radial-gradient(700px 400px at 95% 90%, rgba(6,182,212,0.06), transparent 6%),
                  linear-gradient(180deg, var(--bg), #0a0b0c 60%);
      color:var(--text);
      font-family: Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
      -webkit-font-variant-ligatures: contextual;
    }

    a{color:inherit;text-decoration:none}
    img{display:block;max-width:100%;height:auto}

    /* layout container */
    .container{width:min(1180px,94%);margin-inline:auto}

    /* =======================
       Header / Hero
       ======================= */
    header.hero{
      min-height:320px;
      display:flex;
      align-items:center;
      padding:48px 0;
      position:relative;
      overflow:hidden;
    }

    /* hero background photo (darkened & blurred) */
    .hero::before{
      content:"";
      position:absolute;
      inset:0;
      background-image:
        url("https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1600&q=80");
      background-size:cover;
      background-position:center;
      filter: blur(6px) saturate(.95) brightness(.45);
      transform:scale(1.05);
      z-index:0;
      opacity:1;
    }
    /* soft gradient overlay */
    .hero::after{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(180deg, rgba(2,6,23,0.25) 0%, rgba(2,6,23,0.6) 50%, rgba(2,6,23,0.85) 100%);
      z-index:1;
    }

    .hero-inner{
      position:relative;
      z-index:2;
      display:grid;
      grid-template-columns:1fr 420px;
      gap:28px;
      align-items:center;
      width:100%;
      padding-block:20px;
    }

    .hero-left{
      color:var(--text);
      padding:28px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: 14px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,0.03);
      backdrop-filter: blur(6px) saturate(1.05);
    }

    .hero-left small{color:var(--muted);display:inline-block;margin-bottom:10px}
    .hero-left h1{
      font-family:Poppins, Inter, system-ui, -apple-system;
      font-size: clamp(1.6rem, 3.6vw, 2.6rem);
      margin:6px 0 10px;
      line-height:1.02;
      letter-spacing:-0.6px;
    }
    .hero-left p{color:var(--muted);margin-bottom:14px}

    .hero-ctas{display:flex;gap:12px;flex-wrap:wrap}
    .btn{
      display:inline-flex;align-items:center;gap:10px;padding:.7rem 1rem;border-radius:12px;font-weight:600;
      border:none;cursor:pointer;transition:transform .18s var(--ease), box-shadow .18s var(--ease);
      box-shadow: 0 8px 20px rgba(2,6,23,0.5);
    }
    .btn-primary{
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      color:#061016;
    }
    .btn-ghost{
      background:transparent;
      color:var(--text);
      border:1px solid rgba(255,255,255,0.05);
    }
    .btn:hover{transform:translateY(-4px)}

    /* hero-right preview collage */
    .hero-right{
      padding:12px;
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:8px;
      align-items:stretch;
      justify-items:stretch;
      border-radius:12px;
      overflow:hidden;
    }
    .hero-right .preview{
      width:100%;height:100%;min-height:90px;border-radius:10px;overflow:hidden;position:relative;
      box-shadow: 0 10px 30px rgba(2,6,23,0.45);
      outline:1px solid rgba(255,255,255,0.03);
    }
    .hero-right img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .5s var(--ease)}
    .hero-right .preview:hover img{transform:scale(1.06)}

    /* =======================
       Filters / Search UI
       ======================= */
    .filters{
      display:flex;
      gap:12px;
      align-items:center;
      margin-top:22px;
      flex-wrap:wrap;
    }

    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{
      display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;
      font-weight:600;font-size:.95rem;color:var(--text);
      background:linear-gradient(180deg, rgba(255,255,255,0.016), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      cursor:pointer;transition:transform .15s var(--ease), box-shadow .15s var(--ease);
    }
    .chip:hover{transform:translateY(-3px)}
    .chip.active{
      background: linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#07131a; box-shadow: 0 8px 22px rgba(139,92,246,0.14);
    }

    .search-wrap{
      margin-left:auto;display:flex;align-items:center;gap:8px;
      background:var(--glass);padding:8px;border-radius:999px;border:1px solid rgba(255,255,255,0.03)
    }
    .search-wrap input{
      background:transparent;border:none;color:var(--text);padding:8px 12px;font-size:0.95rem;outline:none;
      width:240px;min-width:140px;
    }
    .search-wrap .icon{opacity:.85}

    /* =======================
       Gallery Masonry grid
       ======================= */

    /* helper masonry using CSS columns */
    .gallery{
      padding:40px 0 80px;
      column-gap:18px;
      width:min(1180px,94%);
      margin-inline:auto;
      -webkit-column-fill: balance;
      column-fill: balance;
      columns: 1;
    }
    @media(min-width:680px){ .gallery{ columns:2 } }
    @media(min-width:1100px){ .gallery{ columns:3 } }

    .card{
      display:inline-block;
      width:100%;
      margin:0 0 18px;
      border-radius:12px;
      overflow:hidden;
      background:var(--card);
      box-shadow: var(--shadow);
      border:1px solid rgba(255,255,255,0.02);
      transform-origin:center;
      transition: transform .28s var(--ease), box-shadow .28s var(--ease);
    }
    .card:hover{ transform: translateY(-6px) }
    .card .media{
      position:relative;width:100%;height:auto;overflow:hidden;background:#0b0f12;
    }
    .card img{width:100%;height:auto;display:block;transition:transform .45s var(--ease)}
    .card:hover img{ transform: scale(1.06) }

    .meta{
      display:flex;align-items:center;justify-content:space-between;padding:12px 14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
    }
    .meta .title{font-weight:700}
    .meta .tag{font-size:0.85rem;color:var(--muted);padding:4px 8px;border-radius:999px;background:rgba(255,255,255,0.02)}

    /* caption overlay (slide-up on hover) */
    .overlay{
      position:absolute;left:0;right:0;bottom:0;padding:12px;background:linear-gradient(180deg, transparent, rgba(2,6,23,0.72));
      color:#fff;transform:translateY(100%);transition:transform .28s var(--ease);
    }
    .card:hover .overlay{ transform:translateY(0) }

    /* slightly different sizes to create variety */
    .h-small{ break-inside: avoid; height:200px }
    .h-medium{ break-inside: avoid; height:300px }
    .h-large{ break-inside: avoid; height:420px }

    /* =======================
       Lightbox / slideshow
       ======================= */
    .lightbox{
      position:fixed;inset:0;display:none;align-items:center;justify-content:center;
      z-index:9999;background:linear-gradient(180deg, rgba(2,6,23,0.9), rgba(2,6,23,0.98));
      padding:40px;
    }
    .lightbox.show{ display:flex }
    .lightbox-inner{
      position:relative;max-width:1200px;width:100%;max-height:90vh;display:grid;grid-template-columns:1fr 360px;gap:18px;
    }
    .lightbox-media{align-self:center;justify-self:center;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .lightbox-media img{max-width:100%;max-height:86vh;border-radius:10px;box-shadow: 0 20px 60px rgba(0,0,0,0.6)}
    .lightbox-side{color:var(--muted);padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));border-radius:10px}
    .lb-close{position:absolute;right:18px;top:18px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:8px;border-radius:10px;cursor:pointer}
    .lb-nav{position:absolute;left:18px;top:50%;transform:translateY(-50%);display:flex;flex-direction:column;gap:10px}
    .lb-btn{background:linear-gradient(135deg,var(--accent),var(--accent-2));border:none;padding:10px 12px;border-radius:10px;color:#061016;font-weight:700;cursor:pointer}
    .lb-thumb-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    .thumb{width:72px;height:52px;border-radius:6px;overflow:hidden;cursor:pointer;border:2px solid rgba(255,255,255,0.03)}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .thumb.active{outline:3px solid rgba(139,92,246,0.16);transform:scale(1.03)}

    /* footer + back button */
    footer{padding:36px 0;color:var(--muted);text-align:center;border-top:1px solid rgba(255,255,255,0.02);margin-top:40px}
    .back-fixed{
      position:fixed;right:20px;bottom:20px;z-index:1000;
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#061016;padding:12px 14px;border-radius:12px;font-weight:700;box-shadow: 0 8px 28px rgba(12,12,20,0.5);
      display:inline-flex;align-items:center;gap:10px;border:none;cursor:pointer;
    }

    /* small screens adjustments */
    @media (max-width:920px){
      .hero-inner{grid-template-columns:1fr}
      .hero-right{display:none}
      .lightbox-inner{grid-template-columns:1fr}
    }
    @media (max-width:560px){
      .search-wrap input{width:140px}
      .chip{font-size:.92rem;padding:6px 10px}
      .hero-left{padding:18px}
    }

    /* reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{transition:none !important;animation:none !important}
    }
  </style>
</head>
<body>
  <!-- HERO -->
  <header class="hero" role="banner" aria-label="Gallery hero">
    <div class="container hero-inner">
      <div class="hero-left" aria-hidden="false">
        <small>Timeless Shots</small>
        <h1>Gallery — curated photography</h1>
        <p>Explore a hand-picked selection of portraits, weddings, events, street and nature images. Click any photo to open the slideshow and browse.</p>

        <div class="filters" aria-hidden="false">
          <div class="chips" role="list" aria-label="Categories">
            <button class="chip active" data-filter="all" role="listitem">All</button>
            <button class="chip" data-filter="Portraits" role="listitem">Portraits</button>
            <button class="chip" data-filter="Weddings" role="listitem">Weddings</button>
            <button class="chip" data-filter="Events" role="listitem">Events</button>
            <button class="chip" data-filter="Street" role="listitem">Street</button>
            <button class="chip" data-filter="Nature" role="listitem">Nature</button>
          </div>

          <div class="search-wrap" role="search" aria-label="Search gallery">
            <svg class="icon" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6.2" stroke="currentColor" stroke-width="1.6"/></svg>
            <input id="searchInput" type="search" placeholder="Search by category or keyword" aria-label="Search images" />
          </div>
        </div>

        <div style="margin-top:14px" aria-hidden="true">
          <button class="btn btn-primary" id="open-first">View Featured</button>
          <a href="index.html" class="btn btn-ghost" style="padding-left:14px">Back to Welcome</a>
        </div>
      </div>

      <div class="hero-right" aria-hidden="true">
        <div class="preview"><img src="https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=900&q=70" alt="Preview portrait" /></div>
        <div class="preview"><img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=900&q=70" alt="Preview street" /></div>
        <div class="preview"><img src="https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=900&q=70" alt="Preview sea" /></div>
        <div class="preview"><img src="https://images.unsplash.com/photo-1520975934072-69bdb0a17de5?auto=format&fit=crop&w=900&q=70" alt="Preview wedding" /></div>
      </div>
    </div>
  </header>

  <!-- GALLERY -->
  <main>
    <section class="gallery" id="gallery" aria-label="Image gallery">
      <!-- Each .card includes a data-category attribute and a data-title for searching.
           Images are Unsplash curated examples (free to use). -->
      <article class="card h-large" data-category="Nature" data-title="Mountain sunrise">
        <div class="media"><img src="https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1600&q=80" alt="Mountain peaked at sunrise" loading="lazy" /></div>
        <div class="overlay"><strong>Mountain sunrise</strong><div style="height:6px"></div><span class="meta"><span class="title">Nature</span></span></div>
      </article>

      <article class="card h-medium" data-category="Portraits" data-title="Warm portrait">
        <div class="media"><img src="https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=1600&q=80" alt="Warm-lit portrait" loading="lazy" /></div>
        <div class="overlay"><strong>Warm portrait</strong><div style="height:6px"></div><span class="meta"><span class="title">Portraits</span></span></div>
      </article>

      <article class="card h-small" data-category="Street" data-title="Evening street">
        <div class="media"><img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1600&q=80" alt="Evening on the city street" loading="lazy" /></div>
        <div class="overlay"><strong>Evening street</strong><div style="height:6px"></div><span class="meta"><span class="title">Street</span></span></div>
      </article>

      <article class="card h-large" data-category="Weddings" data-title="Bride and groom">
        <div class="media"><img src="https://images.unsplash.com/photo-1529635117393-6c2d90d7f6f4?auto=format&fit=crop&w=1600&q=80" alt="Bride and groom candid" loading="lazy" /></div>
        <div class="overlay"><strong>Bride &amp; groom</strong><div style="height:6px"></div><span class="meta"><span class="title">Weddings</span></span></div>
      </article>

      <article class="card h-medium" data-category="Events" data-title="Concert crowd">
        <div class="media"><img src="https://images.unsplash.com/photo-1515169067865-5387ec356754?auto=format&fit=crop&w=1600&q=80" alt="Live concert crowd" loading="lazy" /></div>
        <div class="overlay"><strong>Concert crowd</strong><div style="height:6px"></div><span class="meta"><span class="title">Events</span></span></div>
      </article>

      <article class="card h-small" data-category="Nature" data-title="Forest path">
        <div class="media"><img src="https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1200&q=80" alt="Forest path and trees" loading="lazy" /></div>
        <div class="overlay"><strong>Forest path</strong><div style="height:6px"></div><span class="meta"><span class="title">Nature</span></span></div>
      </article>

      <article class="card h-medium" data-category="Portraits" data-title="Studio headshot">
        <div class="media"><img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=1400&q=80" alt="Studio headshot" loading="lazy" /></div>
        <div class="overlay"><strong>Studio headshot</strong><div style="height:6px"></div><span class="meta"><span class="title">Portraits</span></span></div>
      </article>

      <article class="card h-large" data-category="Street" data-title="City reflections">
        <div class="media"><img src="https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?auto=format&fit=crop&w=1600&q=80" alt="City reflections at night" loading="lazy" /></div>
        <div class="overlay"><strong>City reflections</strong><div style="height:6px"></div><span class="meta"><span class="title">Street</span></span></div>
      </article>

      <article class="card h-small" data-category="Weddings" data-title="Rings closeup">
        <div class="media"><img src="https://images.unsplash.com/photo-1544568109-5b73a8c3b8f3?auto=format&fit=crop&w=1200&q=80" alt="Wedding rings closeup" loading="lazy" /></div>
        <div class="overlay"><strong>Rings closeup</strong><div style="height:6px"></div><span class="meta"><span class="title">Weddings</span></span></div>
      </article>

      <article class="card h-medium" data-category="Events" data-title="Speakers stage">
        <div class="media"><img src="https://images.unsplash.com/photo-1506126613408-eca07ce68773?auto=format&fit=crop&w=1600&q=80" alt="Speaker on stage" loading="lazy" /></div>
        <div class="overlay"><strong>Speakers stage</strong><div style="height:6px"></div><span class="meta"><span class="title">Events</span></span></div>
      </article>

      <article class="card h-large" data-category="Nature" data-title="Coastal cliff">
        <div class="media"><img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1600&q=80" alt="Coastal cliff sea" loading="lazy" /></div>
        <div class="overlay"><strong>Coastal cliff</strong><div style="height:6px"></div><span class="meta"><span class="title">Nature</span></span></div>
      </article>

      <!-- Add more items below as needed — keep the same structure -->
    </section>
  </main>

  <!-- Floating back button -->
  <a class="back-fixed" href="welcomepag.html" aria-label="Back to Welcome Page">⬅ Welcome</a>

  <!-- Lightbox / Slideshow -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-hidden="true" aria-label="Image preview">
    <div class="lightbox-inner" role="document">
      <div class="lightbox-media" id="lightbox-media" aria-live="polite">
        <button class="lb-close" id="lb-close" aria-label="Close preview">✕</button>
        <div class="lb-nav" aria-hidden="false">
          <button class="lb-btn" id="prevBtn" aria-label="Previous image">◀</button>
          <button class="lb-btn" id="nextBtn" aria-label="Next image">▶</button>
        </div>
        <!-- main image -->
        <img id="lb-image" src="" alt="Enlarged preview" />
      </div>

      <aside class="lightbox-side" aria-label="Image details & thumbnails">
        <div id="lb-info">
          <h3 id="lb-title" style="margin:0 0 8px;color:var(--text);font-size:1.08rem"></h3>
          <div id="lb-category" style="color:var(--muted);font-size:.92rem;margin-bottom:12px"></div>
          <p id="lb-desc" style="font-size:.95rem;color:var(--muted);line-height:1.4">High resolution preview — use left/right arrows or the buttons to navigate.</p>
        </div>

        <div style="margin-top:14px">
          <strong style="color:var(--muted);font-size:.87rem">Thumbnails</strong>
          <div class="lb-thumb-row" id="thumbRow" style="margin-top:8px"></div>
        </div>

      </aside>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div style="max-width:980px;margin-inline:auto;padding:8px 20px">
      <p style="margin-bottom:8px;color:var(--muted)">© <span id="year"></span> Timeless Shots • All rights reserved</p>
      <p style="margin:0;color:rgba(255,255,255,0.06);font-size:.92rem">Gallery curated with images from Unsplash (free licence).</p>
    </div>
  </footer>

  <script>
    /* ============================
       Interactivity
       ============================ */

    // Helpers
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

    const gallery = $('#gallery');
    const cards = $$('.card', gallery);
    const chips = $$('.chip');
    const searchInput = $('#searchInput');
    const lightbox = $('#lightbox');
    const lbImage = $('#lb-image');
    const lbTitle = $('#lb-title');
    const lbCategory = $('#lb-category');
    const lbDesc = $('#lb-desc');
    const thumbRow = $('#thumbRow');
    const prevBtn = $('#prevBtn');
    const nextBtn = $('#nextBtn');
    const lbClose = $('#lb-close');
    const openFirst = $('#open-first');
    const yearSpan = $('#year');

    yearSpan.textContent = new Date().getFullYear();

    // Build internal list of images for slideshow (order equals DOM order)
    let items = cards.map(card => {
      const imgEl = card.querySelector('img');
      return {
        el: card,
        src: imgEl.src,
        title: card.dataset.title || '',
        category: card.dataset.category || '',
        alt: imgEl.alt || '',
      };
    });

    // ----- Category chips behavior -----
    function setActiveChip(targetChip){
      chips.forEach(c => c.classList.remove('active'));
      targetChip.classList.add('active');
    }

    chips.forEach(chip => {
      chip.addEventListener('click', () => {
        const filter = chip.dataset.filter.toLowerCase();
        setActiveChip(chip);
        searchInput.value = '';
        filterGallery(filter === 'all' ? '' : filter);
      });
    });

    // ----- Search & filter -----
    function filterGallery(term=''){
      const q = term.trim().toLowerCase() || (searchInput.value || '').toLowerCase();
      // show/hide cards based on title OR category
      cards.forEach(card => {
        const title = (card.dataset.title || '').toLowerCase();
        const cat = (card.dataset.category || '').toLowerCase();
        const matches = q === '' || title.includes(q) || cat.includes(q);
        card.style.display = matches ? 'inline-block' : 'none';
      });
      // refresh items array to reflect shown items (for slideshow navigation)
      items = $$('.card', gallery).filter(c => c.style.display !== 'none').map(card => {
        const img = card.querySelector('img');
        return { el: card, src: img.src, title: card.dataset.title, category: card.dataset.category, alt: img.alt };
      });
      buildThumbs(items);
    }

    searchInput.addEventListener('input', () => {
      // deactivate chips when typing
      chips.forEach(c => c.classList.remove('active'));
      filterGallery();
    });

    // ----- Lightbox behavior -----
    let currentIndex = 0;

    function openLightbox(index){
      if(index < 0 || index >= items.length) return;
      const item = items[index];
      currentIndex = index;
      lbImage.src = item.src;
      lbImage.alt = item.alt || item.title || 'Image preview';
      lbTitle.textContent = item.title || '';
      lbCategory.textContent = item.category ? 'Category: ' + item.category : '';
      lbDesc.textContent = item.alt || '';
      lightbox.classList.add('show');
      lightbox.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      highlightThumb(index);
    }

    function closeLightbox(){
      lightbox.classList.remove('show');
      lightbox.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
    }

    function prevImage(){
      if(items.length === 0) return;
      currentIndex = (currentIndex - 1 + items.length) % items.length;
      openLightbox(currentIndex);
    }
    function nextImage(){
      if(items.length === 0) return;
      currentIndex = (currentIndex + 1) % items.length;
      openLightbox(currentIndex);
    }

    // attach click handlers to visible cards to open lightbox
    function attachCardClickHandlers(){
      cards.forEach((card, idx) => {
        const img = card.querySelector('img');
        img.style.cursor = 'zoom-in';
        img.addEventListener('click', (e) => {
          // compute index in filtered items array
          const filtered = items;
          const clickedSrc = img.src;
          const indexInFiltered = filtered.findIndex(it => it.src === clickedSrc);
          if(indexInFiltered >= 0) openLightbox(indexInFiltered);
        });
      });
    }
    attachCardClickHandlers();

    // build thumbnails in lightbox
    function buildThumbs(list){
      thumbRow.innerHTML = '';
      list.forEach((it, i) => {
        const btn = document.createElement('button');
        btn.className = 'thumb' + (i===currentIndex ? ' active' : '');
        btn.setAttribute('aria-label', it.title || `Image ${i+1}`);
        btn.innerHTML = `<img src="${it.src}" alt="${it.alt || it.title || ''}">`;
        btn.addEventListener('click', () => openLightbox(i));
        thumbRow.appendChild(btn);
      });
    }

    function highlightThumb(i){
      const thumbs = $$('.thumb', thumbRow);
      thumbs.forEach(t => t.classList.remove('active'));
      if(thumbs[i]) thumbs[i].classList.add('active');
    }

    // wire controls
    prevBtn.addEventListener('click', prevImage);
    nextBtn.addEventListener('click', nextImage);
    lbClose.addEventListener('click', closeLightbox);

    // keyboard navigation
    document.addEventListener('keydown', (e) => {
      if(lightbox.classList.contains('show')){
        if(e.key === 'ArrowLeft') prevImage();
        if(e.key === 'ArrowRight') nextImage();
        if(e.key === 'Escape') closeLightbox();
      }
    });

    // click outside image closes
    lightbox.addEventListener('click', (ev) => {
      if(ev.target === lightbox) closeLightbox();
    });

    // open first visible when "View Featured" is clicked
    openFirst.addEventListener('click', () => {
      // ensure items are up-to-date
      filterGallery();
      if(items.length) openLightbox(0);
    });

    // initial build of thumbnails
    filterGallery('');

    // touch swipe support for lightbox (simple)
    (function addSwipe(){
      let startX=0, startY=0, endX=0, endY=0;
      const threshold = 50; // px
      const media = $('#lb-image');
      let active = false;

      document.addEventListener('touchstart', (e)=>{
        if(!lightbox.classList.contains('show')) return;
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
        active = true;
      }, {passive:true});

      document.addEventListener('touchmove', (e)=>{
        if(!active) return;
        endX = e.touches[0].clientX;
        endY = e.touches[0].clientY;
      }, {passive:true});

      document.addEventListener('touchend', ()=>{
        if(!active) return;
        const dx = endX - startX;
        const dy = endY - startY;
        if(Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > threshold){
          if(dx < 0) nextImage(); else prevImage();
        }
        startX = startY = endX = endY = 0;
        active = false;
      }, {passive:true});
    })();

    // Accessibility: focus trap when lightbox open (simple)
    (function focusTrap(){
      const focusableSelector = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
      document.addEventListener('focus', (ev) => {
        if(!lightbox.classList.contains('show')) return;
        const inside = lightbox.contains(ev.target);
        if(!inside) {
          ev.stopPropagation();
          // move focus into lightbox
          $('#lb-close').focus();
        }
      }, true);
    })();

    // ensure filtering updates thumbs if window resized / content changes
    window.addEventListener('resize', () => { buildThumbs(items); });

    // small enhancement: lazy-load new images (already using loading=lazy)
  </script>
</body>
</html>
